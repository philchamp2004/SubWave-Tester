<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schulungstool - LMS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4895ef;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background-color: var(--white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
        }

        .logo img {
            height: 40px;
            margin-right: 10px;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 25px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
            display: flex;
            align-items: center;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .nav-links a i {
            margin-right: 8px;
        }

        .user-menu {
            display: flex;
            align-items: center;
        }

        .user-menu img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .user-menu .dropdown {
            position: relative;
        }

        .dropdown-toggle {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            font-weight: 500;
        }

        .dropdown-menu {
            position: absolute;
            right: 0;
            top: 100%;
            background: var(--white);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 200px;
            display: none;
            z-index: 100;
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            padding: 8px 20px;
            display: block;
            text-decoration: none;
            color: var(--dark);
            transition: background 0.3s;
        }

        .dropdown-item:hover {
            background: var(--gray-light);
        }

        .dropdown-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        main {
            margin-top: 80px;
            padding: 30px 0;
            min-height: calc(100vh - 160px);
        }

        .page-title {
            font-size: 28px;
            margin-bottom: 30px;
            color: var(--dark);
            display: flex;
            align-items: center;
        }

        .page-title i {
            margin-right: 15px;
            color: var(--primary);
        }

        /* Dashboard */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .card-icon.primary {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .card-icon.success {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .card-icon.warning {
            background: rgba(248, 150, 30, 0.1);
            color: var(--warning);
        }

        .card-icon.danger {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
        }

        .card-title {
            font-size: 16px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .card-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .card-link {
            display: flex;
            align-items: center;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
        }

        .card-link i {
            margin-left: 5px;
            transition: transform 0.3s;
        }

        .card-link:hover i {
            transform: translateX(5px);
        }

        /* Courses */
        .courses-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .course-card {
            background: var(--white);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .course-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .course-image {
            height: 160px;
            background-size: cover;
            background-position: center;
        }

        .course-content {
            padding: 20px;
        }

        .course-category {
            display: inline-block;
            background: var(--primary);
            color: var(--white);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .course-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .course-description {
            color: var(--gray);
            font-size: 14px;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .course-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .course-meta-item {
            display: flex;
            align-items: center;
            color: var(--gray);
            font-size: 13px;
        }

        .course-meta-item i {
            margin-right: 5px;
        }

        .course-progress {
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 6px;
            background: var(--gray-light);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .course-actions {
            display: flex;
            justify-content: space-between;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-size: 14px;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: var(--white);
        }

        .btn-sm {
            padding: 8px 15px;
            font-size: 13px;
        }

        /* Admin Panel */
        .admin-panel {
            display: flex;
            margin-top: 30px;
        }

        .admin-sidebar {
            width: 250px;
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 20px 0;
            margin-right: 30px;
            height: fit-content;
        }

        .admin-content {
            flex: 1;
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 30px;
        }

        .admin-nav {
            list-style: none;
        }

        .admin-nav li {
            margin-bottom: 5px;
        }

        .admin-nav a {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .admin-nav a:hover, .admin-nav a.active {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }

        .admin-nav a i {
            margin-right: 10px;
            font-size: 18px;
        }

        .admin-section-title {
            font-size: 20px;
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            align-items: center;
        }

        .admin-section-title i {
            margin-right: 10px;
            color: var(--primary);
        }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray-light);
        }

        .table th {
            background: rgba(67, 97, 238, 0.05);
            color: var(--primary);
            font-weight: 600;
        }

        .table tr:hover td {
            background: rgba(67, 97, 238, 0.03);
        }

        .table .actions {
            display: flex;
            gap: 10px;
        }

        .table .btn-icon {
            width: 35px;
            height: 35px;
            padding: 0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .table .btn-icon i {
            margin: 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-success {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(248, 150, 30, 0.1);
            color: var(--warning);
        }

        .badge-danger {
            background: rgba(247, 37, 133, 0.1);
            color: var(--danger);
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            font-size: 14px;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            font-size: 14px;
            background-color: var(--white);
            cursor: pointer;
        }

        .form-row {
            display: flex;
            gap: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Quiz */
        .quiz-container {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 30px;
        }

        .quiz-header {
            margin-bottom: 30px;
        }

        .quiz-title {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .quiz-description {
            color: var(--gray);
            margin-bottom: 20px;
        }

        .quiz-progress {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .progress-text {
            margin-right: 15px;
            font-weight: 500;
            color: var(--gray);
        }

        .question-card {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .options-list {
            list-style: none;
        }

        .option-item {
            margin-bottom: 15px;
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-label:hover {
            border-color: var(--primary);
        }

        .option-input {
            margin-right: 15px;
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        /* Certificate */
        .certificate-container {
            background: #f9f9f9;
            border: 20px solid #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
            padding: 50px;
            text-align: center;
            position: relative;
        }

        .certificate-border {
            border: 2px solid var(--primary);
            padding: 40px;
            position: relative;
        }

        .certificate-logo {
            margin-bottom: 30px;
        }

        .certificate-logo img {
            height: 80px;
        }

        .certificate-title {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .certificate-subtitle {
            font-size: 18px;
            color: var(--gray);
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .certificate-text {
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .certificate-user {
            font-size: 28px;
            font-weight: 600;
            margin: 20px 0;
            color: var(--dark);
        }

        .certificate-course {
            font-size: 22px;
            font-weight: 500;
            margin-bottom: 30px;
            color: var(--primary);
        }

        .certificate-date {
            font-size: 16px;
            margin-bottom: 30px;
        }

        .certificate-signatures {
            display: flex;
            justify-content: space-around;
            margin-top: 50px;
        }

        .signature {
            display: inline-block;
            width: 200px;
            border-top: 1px solid var(--dark);
            padding-top: 10px;
            margin: 0 20px;
        }

        .certificate-stamp {
            position: absolute;
            right: 80px;
            bottom: 80px;
            opacity: 0.8;
            width: 120px;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-dialog {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-50px);
            transition: transform 0.3s;
        }

        .modal.show .modal-dialog {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f5f7fb;
        }

        .login-card {
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            padding: 40px;
        }

        .login-logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-logo img {
            height: 80px;
            margin-bottom: 15px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
        }

        .login-footer {
            text-align: center;
            margin-top: 20px;
            color: var(--gray);
        }

        /* Responsive */
        @media (max-width: 992px) {
            .admin-panel {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                margin-right: 0;
                margin-bottom: 30px;
            }
            
            .admin-nav {
                display: flex;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .admin-nav li {
                margin-bottom: 0;
                margin-right: 10px;
                white-space: nowrap;
            }
            
            .admin-nav a {
                border-left: none;
                border-bottom: 3px solid transparent;
            }
            
            .admin-nav a:hover, .admin-nav a.active {
                border-left: none;
                border-bottom: 3px solid var(--primary);
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .nav-links {
                margin-top: 15px;
                width: 100%;
                justify-content: space-between;
            }
            
            .nav-links li {
                margin-left: 0;
            }
            
            .user-menu {
                margin-top: 15px;
                width: 100%;
                justify-content: flex-end;
            }
            
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            
            .courses-container {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }

        /* Utility Classes */
        .text-center {
            text-align: center;
        }
        
        .text-right {
            text-align: right;
        }
        
        .mb-0 {
            margin-bottom: 0 !important;
        }
        
        .mt-0 {
            margin-top: 0 !important;
        }
        
        .mb-20 {
            margin-bottom: 20px !important;
        }
        
        .mt-20 {
            margin-top: 20px !important;
        }
        
        .d-flex {
            display: flex;
        }
        
        .align-items-center {
            align-items: center;
        }
        
        .justify-content-between {
            justify-content: space-between;
        }
        
        .w-100 {
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Login Page (shown by default) -->
    <div id="login-page" class="login-container">
        <div class="login-card">
            <div class="login-logo">
                <img src="https://via.placeholder.com/150x80?text=SCHULUNGSTOOL" alt="Logo" id="login-logo-img">
            </div>
            <h1 class="login-title">Anmeldung</h1>
            
            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">E-Mail</label>
                    <input type="email" class="form-control" id="login-email" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Passwort</label>
                    <input type="password" class="form-control" id="login-password" required>
                </div>
                
                <div class="form-group">
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt"></i> Anmelden
                    </button>
                </div>
                
                <!-- Removed register link as per requirements -->
            </form>
        </div>
    </div>

    <!-- Main Application (hidden by default) -->
    <div id="app-container" style="display: none;">
        <!-- Header -->
        <header>
            <div class="container header-container">
                <a href="#" class="logo" onclick="showPage('dashboard')">
                    <img src="https://via.placeholder.com/150x80?text=SCHULUNGSTOOL" alt="Logo" id="header-logo-img">
                    <span id="header-system-name">Schulungstool</span>
                </a>
                <ul class="nav-links">
                    <li><a href="#" onclick="showPage('dashboard')"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="#" onclick="showPage('courses')"><i class="fas fa-book"></i> Kurse</a></li>
                    <li><a href="#" onclick="showPage('certificates')"><i class="fas fa-certificate"></i> Zertifikate</a></li>
                    <li class="admin-link" style="display: none;"><a href="#" onclick="showPage('admin')"><i class="fas fa-cog"></i> Admin</a></li>
                </ul>
                <div class="user-menu">
                    <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" id="user-avatar">
                    <div class="dropdown">
                        <button class="dropdown-toggle" id="dropdownMenuButton">
                            <span id="username">Max Mustermann</span> <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="dropdownMenu">
                            <a href="#" class="dropdown-item" onclick="showPage('profile')"><i class="fas fa-user"></i> Profil</a>
                            <a href="#" class="dropdown-item" onclick="showPage('settings')"><i class="fas fa-cog"></i> Einstellungen</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Abmelden</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <div class="container">
                <!-- Dashboard Page -->
                <div id="dashboard-page" class="page">
                    <h1 class="page-title"><i class="fas fa-tachometer-alt"></i> Dashboard</h1>
                    
                    <div class="dashboard-cards">
                        <div class="card">
                            <div class="card-icon primary">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <h3 class="card-title">Aktive Kurse</h3>
                            <p class="card-value" id="active-courses-count">3</p>
                            <a href="#" class="card-link" onclick="showPage('courses')">
                                Alle Kurse anzeigen <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                        
                        <div class="card">
                            <div class="card-icon success">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 class="card-title">Abgeschlossene Kurse</h3>
                            <p class="card-value" id="completed-courses-count">5</p>
                            <a href="#" class="card-link" onclick="showPage('certificates')">
                                Zertifikate anzeigen <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                        
                        <div class="card">
                            <div class="card-icon warning">
                                <i class="fas fa-clock"></i>
                            </div>
                            <h3 class="card-title">Laufende Kurse</h3>
                            <p class="card-value" id="inprogress-courses-count">2</p>
                            <a href="#" class="card-link" onclick="showPage('courses')">
                                Fortsetzen <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                        
                        <div class="card">
                            <div class="card-icon danger">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <h3 class="card-title">Punkte</h3>
                            <p class="card-value" id="points-count">1,250</p>
                            <a href="#" class="card-link" onclick="showPage('profile')">
                                Rangliste anzeigen <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                    
                    <h2 class="page-title"><i class="fas fa-book"></i> Meine aktuellen Kurse</h2>
                    
                    <div class="courses-container" id="current-courses">
                        <!-- Current courses will be loaded here -->
                    </div>
                </div>
                
                <!-- Courses Page -->
                <div id="courses-page" class="page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-20">
                        <h1 class="page-title"><i class="fas fa-book"></i> Alle Kurse</h1>
                        <div class="admin-controls" style="display: none;">
                            <button class="btn btn-primary" onclick="showAddCourseModal()">
                                <i class="fas fa-plus"></i> Neuen Kurs erstellen
                            </button>
                        </div>
                    </div>
                    
                    <div class="courses-container" id="all-courses">
                        <!-- All courses will be loaded here -->
                    </div>
                </div>
                
                <!-- Course Detail Page -->
                <div id="course-detail-page" class="page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-20">
                        <h1 class="page-title" id="course-detail-title"><i class="fas fa-book"></i> Kursdetails</h1>
                        <div>
                            <button class="btn btn-outline" onclick="showPage('courses')">
                                <i class="fas fa-arrow-left"></i> Zurück zu Kursen
                            </button>
                            <div class="admin-controls" style="display: none; margin-left: 10px;">
                                <button class="btn btn-primary" id="edit-course-btn" onclick="editCourse(currentState.currentCourse.id)">
                                    <i class="fas fa-edit"></i> Kurs bearbeiten
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="course-detail-container">
                        <div class="course-image" id="course-detail-image" style="height: 300px; border-radius: 10px; margin-bottom: 30px;"></div>
                        
                        <div class="form-row">
                            <div style="flex: 2;">
                                <h2 id="course-detail-name"></h2>
                                <p class="course-category" id="course-detail-category"></p>
                                <p id="course-detail-description" style="margin-bottom: 20px;"></p>
                                
                                <div class="course-meta">
                                    <div class="course-meta-item">
                                        <i class="fas fa-clock"></i> <span id="course-detail-duration">0</span> Stunden
                                    </div>
                                    <div class="course-meta-item">
                                        <i class="fas fa-layer-group"></i> <span id="course-detail-level">Anfänger</span>
                                    </div>
                                    <div class="course-meta-item">
                                        <i class="fas fa-users"></i> <span id="course-detail-students">0</span> Teilnehmer
                                    </div>
                                </div>
                                
                                <div class="course-progress" id="course-progress-section" style="margin: 30px 0;">
                                    <div class="d-flex justify-content-between mb-10">
                                        <span>Fortschritt</span>
                                        <span id="course-progress-percent">0%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="course-progress-bar" style="width: 0%;"></div>
                                    </div>
                                </div>
                                
                                <div class="course-actions" id="course-actions">
                                    <!-- Buttons will be loaded here -->
                                </div>
                            </div>
                            
                            <div style="flex: 1; margin-left: 30px;">
                                <div class="card">
                                    <h3 style="margin-bottom: 15px;">Kursinhalte</h3>
                                    <div id="course-modules">
                                        <!-- Modules will be loaded here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quiz Page -->
                <div id="quiz-page" class="page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-20">
                        <h1 class="page-title"><i class="fas fa-question-circle"></i> Kursprüfung</h1>
                        <button class="btn btn-outline" onclick="backToCourseDetail()">
                            <i class="fas fa-arrow-left"></i> Zurück zum Kurs
                        </button>
                    </div>
                    
                    <div class="quiz-container">
                        <div class="quiz-header">
                            <h2 class="quiz-title" id="quiz-title">Prüfung: Einführung in HTML</h2>
                            <p class="quiz-description" id="quiz-description">Beantworten Sie alle Fragen, um den Kurs abzuschließen und Ihr Zertifikat zu erhalten.</p>
                            
                            <div class="quiz-progress">
                                <span class="progress-text">Fortschritt:</span>
                                <div style="flex: 1; margin: 0 10px;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="quiz-progress-bar" style="width: 0%;"></div>
                                    </div>
                                </div>
                                <span id="quiz-progress-text">0/10</span>
                            </div>
                        </div>
                        
                        <div id="quiz-questions">
                            <!-- Questions will be loaded here -->
                        </div>
                        
                        <div class="quiz-navigation">
                            <button class="btn btn-outline" id="prev-question-btn" disabled>
                                <i class="fas fa-arrow-left"></i> Vorherige Frage
                            </button>
                            <button class="btn btn-primary" id="next-question-btn">
                                Nächste Frage <i class="fas fa-arrow-right"></i>
                            </button>
                            <button class="btn btn-primary" id="finish-quiz-btn" style="display: none;">
                                Prüfung abschließen <i class="fas fa-check"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Certificates Page -->
                <div id="certificates-page" class="page" style="display: none;">
                    <h1 class="page-title"><i class="fas fa-certificate"></i> Meine Zertifikate</h1>
                    
                    <div class="courses-container" id="certificates-list">
                        <!-- Certificates will be loaded here -->
                    </div>
                </div>
                
                <!-- Certificate Detail Page -->
                <div id="certificate-detail-page" class="page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-20">
                        <h1 class="page-title"><i class="fas fa-certificate"></i> Zertifikat</h1>
                        <div>
                            <button class="btn btn-outline" onclick="showPage('certificates')">
                                <i class="fas fa-arrow-left"></i> Zurück zu Zertifikaten
                            </button>
                            <button class="btn btn-primary" onclick="printCertificate()" style="margin-left: 10px;">
                                <i class="fas fa-print"></i> Drucken
                            </button>
                        </div>
                    </div>
                    
                    <div class="certificate-container" id="certificate-container">
                        <div class="certificate-border">
                            <div class="certificate-logo">
                                <img src="https://via.placeholder.com/150x80?text=SCHULUNGSTOOL" alt="Logo" id="certificate-logo-img">
                            </div>
                            <h2 class="certificate-title">Zertifikat</h2>
                            <h3 class="certificate-subtitle">Bescheinigung der erfolgreichen Teilnahme</h3>
                            
                            <p class="certificate-text">
                                Hiermit wird bescheinigt, dass
                            </p>
                            
                            <h3 class="certificate-user" id="certificate-user-name">Max Mustermann</h3>
                            
                            <p class="certificate-text">
                                den Kurs
                            </p>
                            
                            <h3 class="certificate-course" id="certificate-course-name">Einführung in HTML und CSS</h3>
                            
                            <p class="certificate-text">
                                erfolgreich abgeschlossen und alle erforderlichen Prüfungen bestanden hat.
                            </p>
                            
                            <p class="certificate-date" id="certificate-date">
                                Ausgestellt am: 01. Januar 2023
                            </p>
                            
                            <div class="certificate-signatures">
                                <div class="signature">Unterschrift Trainer</div>
                                <div class="signature">Unterschrift Teilnehmer</div>
                            </div>
                            
                            <img src="https://via.placeholder.com/120x120?text=SCHULUNGSTOOL" alt="Stamp" class="certificate-stamp">
                        </div>
                    </div>
                </div>
                
                <!-- Admin Page -->
                <div id="admin-page" class="page" style="display: none;">
                    <h1 class="page-title"><i class="fas fa-cog"></i> Admin Dashboard</h1>
                    
                    <div class="admin-panel">
                        <div class="admin-sidebar">
                            <ul class="admin-nav">
                                <li><a href="#" class="active" onclick="showAdminSection('dashboard')"><i class="fas fa-tachometer-alt"></i> Übersicht</a></li>
                                <li><a href="#" onclick="showAdminSection('users')"><i class="fas fa-users"></i> Benutzer</a></li>
                                <li><a href="#" onclick="showAdminSection('courses')"><i class="fas fa-book"></i> Kurse</a></li>
                                <li><a href="#" onclick="showAdminSection('certificates')"><i class="fas fa-certificate"></i> Zertifikate</a></li>
                                <li><a href="#" onclick="showAdminSection('reports')"><i class="fas fa-chart-bar"></i> Berichte</a></li>
                                <li><a href="#" onclick="showAdminSection('settings')"><i class="fas fa-cog"></i> Einstellungen</a></li>
                            </ul>
                        </div>
                        
                        <div class="admin-content">
                            <!-- Admin Dashboard -->
                            <div id="admin-dashboard-section">
                                <h2 class="admin-section-title"><i class="fas fa-tachometer-alt"></i> Übersicht</h2>
                                
                                <div class="dashboard-cards">
                                    <div class="card">
                                        <div class="card-icon primary">
                                            <i class="fas fa-users"></i>
                                        </div>
                                        <h3 class="card-title">Benutzer</h3>
                                        <p class="card-value" id="admin-users-count">125</p>
                                        <a href="#" class="card-link" onclick="showAdminSection('users')">
                                            Alle Benutzer anzeigen <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                    
                                    <div class="card">
                                        <div class="card-icon success">
                                            <i class="fas fa-book"></i>
                                        </div>
                                        <h3 class="card-title">Kurse</h3>
                                        <p class="card-value" id="admin-courses-count">28</p>
                                        <a href="#" class="card-link" onclick="showAdminSection('courses')">
                                            Alle Kurse anzeigen <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                    
                                    <div class="card">
                                        <div class="card-icon warning">
                                            <i class="fas fa-certificate"></i>
                                        </div>
                                        <h3 class="card-title">Zertifikate</h3>
                                        <p class="card-value" id="admin-certificates-count">342</p>
                                        <a href="#" class="card-link" onclick="showAdminSection('certificates')">
                                            Alle Zertifikate anzeigen <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                    
                                    <div class="card">
                                        <div class="card-icon danger">
                                            <i class="fas fa-chart-line"></i>
                                        </div>
                                        <h3 class="card-title">Aktivität</h3>
                                        <p class="card-value" id="admin-activity-count">78%</p>
                                        <a href="#" class="card-link" onclick="showAdminSection('reports')">
                                            Berichte anzeigen <i class="fas fa-arrow-right"></i>
                                        </a>
                                    </div>
                                </div>
                                
                                <h3 class="admin-section-title"><i class="fas fa-clock"></i> Aktuelle Aktivitäten</h3>
                                
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Benutzer</th>
                                                <th>Aktivität</th>
                                                <th>Kurs</th>
                                                <th>Zeit</th>
                                            </tr>
                                        </thead>
                                        <tbody id="admin-activities">
                                            <!-- Activities will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Users Management -->
                            <div id="admin-users-section" style="display: none;">
                                <div class="d-flex justify-content-between align-items-center mb-20">
                                    <h2 class="admin-section-title"><i class="fas fa-users"></i> Benutzerverwaltung</h2>
                                    <button class="btn btn-primary" onclick="showAddUserModal()">
                                        <i class="fas fa-plus"></i> Neuen Benutzer anlegen
                                    </button>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Name</th>
                                                <th>E-Mail</th>
                                                <th>Rolle</th>
                                                <th>Status</th>
                                                <th>Aktionen</th>
                                            </tr>
                                        </thead>
                                        <tbody id="admin-users-list">
                                            <!-- Users will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Courses Management -->
                            <div id="admin-courses-section" style="display: none;">
                                <div class="d-flex justify-content-between align-items-center mb-20">
                                    <h2 class="admin-section-title"><i class="fas fa-book"></i> Kursverwaltung</h2>
                                    <button class="btn btn-primary" onclick="showAddCourseModal()">
                                        <i class="fas fa-plus"></i> Neuen Kurs erstellen
                                    </button>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Name</th>
                                                <th>Kategorie</th>
                                                <th>Teilnehmer</th>
                                                <th>Status</th>
                                                <th>Aktionen</th>
                                            </tr>
                                        </thead>
                                        <tbody id="admin-courses-list">
                                            <!-- Courses will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Certificates Management -->
                            <div id="admin-certificates-section" style="display: none;">
                                <h2 class="admin-section-title"><i class="fas fa-certificate"></i> Zertifikatsverwaltung</h2>
                                
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Benutzer</th>
                                                <th>Kurs</th>
                                                <th>Datum</th>
                                                <th>Note</th>
                                                <th>Aktionen</th>
                                            </tr>
                                        </thead>
                                        <tbody id="admin-certificates-list">
                                            <!-- Certificates will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Reports -->
                            <div id="admin-reports-section" style="display: none;">
                                <h2 class="admin-section-title"><i class="fas fa-chart-bar"></i> Berichte und Statistiken</h2>
                                
                                <div class="dashboard-cards">
                                    <div class="card">
                                        <div class="card-icon primary">
                                            <i class="fas fa-user-graduate"></i>
                                        </div>
                                        <h3 class="card-title">Abschlussrate</h3>
                                        <p class="card-value" id="completion-rate">78%</p>
                                        <p class="card-title">aller begonnenen Kurse</p>
                                    </div>
                                    
                                    <div class="card">
                                        <div class="card-icon success">
                                            <i class="fas fa-star"></i>
                                        </div>
                                        <h3 class="card-title">Durchschnittsnote</h3>
                                        <p class="card-value" id="average-grade">1.8</p>
                                        <p class="card-title">aller Prüfungen</p>
                                    </div>
                                    
                                    <div class="card">
                                        <div class="card-icon warning">
                                            <i class="fas fa-clock"></i>
                                        </div>
                                        <h3 class="card-title">Durchschnittliche Zeit</h3>
                                        <p class="card-value" id="average-time">4.2</p>
                                        <p class="card-title">Stunden pro Kurs</p>
                                    </div>
                                </div>
                                
                                <div class="card" style="margin-top: 30px;">
                                    <h3 class="admin-section-title"><i class="fas fa-chart-line"></i> Aktivitätsverlauf</h3>
                                    <div style="height: 300px; background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: var(--gray);">
                                        [Hier würde ein Diagramm der Aktivitäten über die Zeit angezeigt werden]
                                    </div>
                                </div>
                                
                                <div class="card" style="margin-top: 30px;">
                                    <h3 class="admin-section-title"><i class="fas fa-book"></i> Beliebte Kurse</h3>
                                    <div style="height: 300px; background: #f8f9fa; display: flex; align-items: center; justify-content: center; color: var(--gray);">
                                        [Hier würde ein Diagramm der beliebtesten Kurse angezeigt werden]
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Settings -->
                            <div id="admin-settings-section" style="display: none;">
                                <h2 class="admin-section-title"><i class="fas fa-cog"></i> Systemeinstellungen</h2>
                                
                                <form id="system-settings-form">
                                    <div class="form-group">
                                        <label class="form-label">Systemname</label>
                                        <input type="text" class="form-control" id="system-name" value="Schulungstool">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Standardrolle für neue Benutzer</label>
                                        <select class="form-select" id="default-role">
                                            <option value="user">Teilnehmer</option>
                                            <option value="trainer">Trainer</option>
                                            <option value="admin">Administrator</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Mindestpunktzahl für Bestehen (%)</label>
                                        <input type="number" class="form-control" id="passing-score" value="70" min="0" max="100">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Systemlogo</label>
                                        <input type="file" class="form-control" id="logo-upload" accept="image/*">
                                        <small class="text-muted">Empfohlene Größe: 150x80 Pixel</small>
                                    </div>
                                    
                                    <div class="form-group text-right">
                                        <button type="button" class="btn btn-outline" style="margin-right: 10px;" onclick="resetSettings()">
                                            Zurücksetzen
                                        </button>
                                        <button type="button" class="btn btn-primary" onclick="saveSystemSettings()">
                                            <i class="fas fa-save"></i> Einstellungen speichern
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Profile Page -->
                <div id="profile-page" class="page" style="display: none;">
                    <h1 class="page-title"><i class="fas fa-user"></i> Mein Profil</h1>
                    
                    <div class="form-row">
                        <div style="flex: 1; margin-right: 30px;">
                            <div class="card" style="padding: 30px; text-align: center;">
                                <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" id="profile-avatar" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin: 0 auto 20px;">
                                <h2 id="profile-name">Max Mustermann</h2>
                                <p class="badge badge-success" id="profile-role">Teilnehmer</p>
                                <p style="margin: 20px 0; color: var(--gray);" id="profile-email">max.mustermann@example.com</p>
                                
                                <button class="btn btn-outline w-100" onclick="document.getElementById('profile-avatar-input').click()">
                                    <i class="fas fa-camera"></i> Profilbild ändern
                                </button>
                                <input type="file" id="profile-avatar-input" style="display: none;">
                            </div>
                            
                            <div class="card" style="margin-top: 20px; padding: 20px;">
                                <h3 style="margin-bottom: 15px;">Statistiken</h3>
                                
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Abgeschlossene Kurse:</span>
                                    <strong id="profile-completed-courses">5</strong>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Aktive Kurse:</span>
                                    <strong id="profile-active-courses">2</strong>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                    <span>Gesamtpunktzahl:</span>
                                    <strong id="profile-points">1,250</strong>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between;">
                                    <span>Durchschnittsnote:</span>
                                    <strong id="profile-average-grade">1.8</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div style="flex: 2;">
                            <div class="card" style="padding: 30px;">
                                <h3 style="margin-bottom: 20px;">Profilinformationen</h3>
                                
                                <form id="profile-form">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Vorname</label>
                                            <input type="text" class="form-control" id="profile-firstname" value="Max">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Nachname</label>
                                            <input type="text" class="form-control" id="profile-lastname" value="Mustermann">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">E-Mail</label>
                                        <input type="email" class="form-control" id="profile-email-input" value="max.mustermann@example.com">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Telefon</label>
                                        <input type="tel" class="form-control" id="profile-phone" value="+49 123 456789">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Position</label>
                                        <input type="text" class="form-control" id="profile-position" value="Mitarbeiter">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Abteilung</label>
                                        <input type="text" class="form-control" id="profile-department" value="IT">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Über mich</label>
                                        <textarea class="form-control" id="profile-about" rows="4">Ich bin ein motivierter Mitarbeiter, der gerne neue Dinge lernt.</textarea>
                                    </div>
                                    
                                    <div class="form-group text-right">
                                        <button type="button" class="btn btn-outline" style="margin-right: 10px;">
                                            Abbrechen
                                        </button>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save"></i> Änderungen speichern
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <div class="card" style="margin-top: 20px; padding: 30px;">
                                <h3 style="margin-bottom: 20px;">Passwort ändern</h3>
                                
                                <form id="password-form">
                                    <div class="form-group">
                                        <label class="form-label">Aktuelles Passwort</label>
                                        <input type="password" class="form-control" id="current-password">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Neues Passwort</label>
                                        <input type="password" class="form-control" id="new-password">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Neues Passwort bestätigen</label>
                                        <input type="password" class="form-control" id="confirm-password">
                                    </div>
                                    
                                    <div class="form-group text-right">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save"></i> Passwort aktualisieren
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Page -->
                <div id="settings-page" class="page" style="display: none;">
                    <h1 class="page-title"><i class="fas fa-cog"></i> Einstellungen</h1>
                    
                    <div class="card" style="padding: 30px;">
                        <h3 style="margin-bottom: 20px;">Benachrichtigungseinstellungen</h3>
                        
                        <form id="notification-settings">
                            <div class="form-group">
                                <label class="form-label">E-Mail-Benachrichtigungen</label>
                                <div style="margin-top: 10px;">
                                    <label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;" checked> Neue Kurse
                                    </label>
                                    <label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;" checked> Kurserinnerungen
                                    </label>
                                    <label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;"> Systemnachrichten
                                    </label>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Push-Benachrichtigungen</label>
                                <div style="margin-top: 10px;">
                                    <label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;" checked> Kursfortschritt
                                    </label>
                                    <label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer;">
                                        <input type="checkbox" style="margin-right: 10px;"> Prüfungsergebnisse
                                    </label>
                                </div>
                            </div>
                            
                            <div class="form-group text-right">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Einstellungen speichern
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer style="background: var(--dark); color: var(--white); padding: 30px 0; margin-top: 50px;">
            <div class="container">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <p>&copy; 2023 <span id="footer-system-name">Schulungstool</span>. Alle Rechte vorbehalten.</p>
                    </div>
                    <div>
                        <a href="#" style="color: var(--white); margin-left: 20px;">Impressum</a>
                        <a href="#" style="color: var(--white); margin-left: 20px;">Datenschutz</a>
                        <a href="#" style="color: var(--white); margin-left: 20px;">AGB</a>
                        <a href="#" style="color: var(--white); margin-left: 20px;">Kontakt</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Add User Modal -->
    <div class="modal" id="add-user-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Neuen Benutzer anlegen</h3>
                <button class="modal-close" onclick="closeModal('add-user-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-user-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vorname</label>
                            <input type="text" class="form-control" id="add-user-firstname" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nachname</label>
                            <input type="text" class="form-control" id="add-user-lastname" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">E-Mail</label>
                        <input type="email" class="form-control" id="add-user-email" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Rolle</label>
                        <select class="form-select" id="add-user-role" required>
                            <option value="">Bitte wählen</option>
                            <option value="admin">Administrator</option>
                            <option value="trainer">Trainer</option>
                            <option value="user" selected>Teilnehmer</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Passwort</label>
                        <input type="password" class="form-control" id="add-user-password" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Passwort bestätigen</label>
                        <input type="password" class="form-control" id="add-user-confirm-password" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('add-user-modal')">Abbrechen</button>
                <button class="btn btn-primary" onclick="addNewUser()">Benutzer anlegen</button>
            </div>
        </div>
    </div>
    
    <!-- Add Course Modal -->
    <div class="modal" id="add-course-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Neuen Kurs erstellen</h3>
                <button class="modal-close" onclick="closeModal('add-course-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-course-form">
                    <div class="form-group">
                        <label class="form-label">Kursname</label>
                        <input type="text" class="form-control" id="course-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Kategorie</label>
                        <select class="form-select" id="course-category" required>
                            <option value="">Bitte wählen</option>
                            <option value="IT & Software">IT & Software</option>
                            <option value="Business">Business</option>
                            <option value="Design">Design</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Persönliche Entwicklung">Persönliche Entwicklung</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Schwierigkeitsgrad</label>
                        <select class="form-select" id="course-level" required>
                            <option value="Anfänger">Anfänger</option>
                            <option value="Mittelstufe">Mittelstufe</option>
                            <option value="Fortgeschritten">Fortgeschritten</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Beschreibung</label>
                        <textarea class="form-control" id="course-description" rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Kursbild</label>
                        <input type="file" class="form-control" id="course-image" accept="image/*">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Dauer (Stunden)</label>
                            <input type="number" class="form-control" id="course-duration" min="1" value="4">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mindestpunktzahl (%)</label>
                            <input type="number" class="form-control" id="course-passing-score" min="0" max="100" value="70">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('add-course-modal')">Abbrechen</button>
                <button class="btn btn-primary" onclick="addNewCourse()">Kurs erstellen</button>
            </div>
        </div>
    </div>
    
    <!-- Edit Course Modal -->
    <div class="modal" id="edit-course-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Kurs bearbeiten</h3>
                <button class="modal-close" onclick="closeModal('edit-course-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-course-form">
                    <div class="form-group">
                        <label class="form-label">Kursname</label>
                        <input type="text" class="form-control" id="edit-course-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Kategorie</label>
                        <select class="form-select" id="edit-course-category" required>
                            <option value="">Bitte wählen</option>
                            <option value="IT & Software">IT & Software</option>
                            <option value="Business">Business</option>
                            <option value="Design">Design</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Persönliche Entwicklung">Persönliche Entwicklung</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Schwierigkeitsgrad</label>
                        <select class="form-select" id="edit-course-level" required>
                            <option value="Anfänger">Anfänger</option>
                            <option value="Mittelstufe">Mittelstufe</option>
                            <option value="Fortgeschritten">Fortgeschritten</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Beschreibung</label>
                        <textarea class="form-control" id="edit-course-description" rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Kursbild</label>
                        <input type="file" class="form-control" id="edit-course-image" accept="image/*">
                        <small class="text-muted">Aktuelles Bild: <span id="current-course-image-name"></span></small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Dauer (Stunden)</label>
                            <input type="number" class="form-control" id="edit-course-duration" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mindestpunktzahl (%)</label>
                            <input type="number" class="form-control" id="edit-course-passing-score" min="0" max="100">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('edit-course-modal')">Abbrechen</button>
                <button class="btn btn-primary" onclick="saveCourseChanges()">Änderungen speichern</button>
            </div>
        </div>
    </div>
    
    <!-- Add Module Modal -->
    <div class="modal" id="add-module-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Neues Modul hinzufügen</h3>
                <button class="modal-close" onclick="closeModal('add-module-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-module-form">
                    <div class="form-group">
                        <label class="form-label">Modulname</label>
                        <input type="text" class="form-control" id="module-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Beschreibung</label>
                        <textarea class="form-control" id="module-description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Inhaltstyp</label>
                        <select class="form-select" id="module-type" required>
                            <option value="">Bitte wählen</option>
                            <option value="video">Video</option>
                            <option value="document">Dokument</option>
                            <option value="quiz">Quiz</option>
                            <option value="assignment">Aufgabe</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="module-video-url" style="display: none;">
                        <label class="form-label">Video-URL</label>
                        <input type="url" class="form-control" id="module-video-input" placeholder="https://">
                    </div>
                    
                    <div class="form-group" id="module-file-upload" style="display: none;">
                        <label class="form-label">Datei hochladen</label>
                        <input type="file" class="form-control" id="module-file-input">
                    </div>
                    
                    <div class="form-group" id="module-quiz-options" style="display: none;">
                        <label class="form-label">Anzahl Fragen</label>
                        <input type="number" class="form-control" id="module-quiz-questions" min="1" value="5">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('add-module-modal')">Abbrechen</button>
                <button class="btn btn-primary" onclick="addNewModule()">Modul hinzufügen</button>
            </div>
        </div>
    </div>
    
    <!-- Add Question Modal -->
    <div class="modal" id="add-question-modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Neue Frage hinzufügen</h3>
                <button class="modal-close" onclick="closeModal('add-question-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-question-form">
                    <div class="form-group">
                        <label class="form-label">Frage</label>
                        <textarea class="form-control" id="question-text" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Fragentyp</label>
                        <select class="form-select" id="question-type" required>
                            <option value="single">Einzelauswahl</option>
                            <option value="multiple">Mehrfachauswahl</option>
                            <option value="text">Textantwort</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Punkte</label>
                        <input type="number" class="form-control" id="question-points" min="1" value="1">
                    </div>
                    
                    <div id="question-options-container">
                        <div class="form-group">
                            <label class="form-label">Optionen</label>
                            <div class="d-flex align-items-center mb-10">
                                <input type="text" class="form-control" placeholder="Optionstext" style="flex: 1;">
                                <label style="margin-left: 10px; display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" style="margin-right: 5px;"> Korrekt
                                </label>
                                <button class="btn btn-outline btn-sm" style="margin-left: 10px;" onclick="removeOption(this)">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="d-flex align-items-center mb-10">
                                <input type="text" class="form-control" placeholder="Optionstext" style="flex: 1;">
                                <label style="margin-left: 10px; display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" style="margin-right: 5px;"> Korrekt
                                </label>
                                <button class="btn btn-outline btn-sm" style="margin-left: 10px;" onclick="removeOption(this)">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline btn-sm" onclick="addNewOption()">
                            <i class="fas fa-plus"></i> Option hinzufügen
                        </button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('add-question-modal')">Abbrechen</button>
                <button class="btn btn-primary" onclick="addNewQuestion()">Frage speichern</button>
            </div>
        </div>
    </div>

    <script>
        // Sample data for the application
        const sampleData = {
            users: [
                {
                    id: 1,
                    firstName: "Admin",
                    lastName: "User",
                    email: "admin@example.com",
                    password: "admin123",
                    avatar: "https://randomuser.me/api/portraits/men/32.jpg",
                    role: "admin",
                    position: "Administrator",
                    department: "IT",
                    about: "Ich bin der Systemadministrator",
                    phone: "+49 123 456789",
                    points: 1250,
                    completedCourses: 5,
                    activeCourses: 2,
                    averageGrade: 1.8,
                    status: "active"
                },
                {
                    id: 2,
                    firstName: "Anna",
                    lastName: "Schmidt",
                    email: "anna@example.com",
                    password: "password123",
                    avatar: "https://randomuser.me/api/portraits/women/44.jpg",
                    role: "trainer",
                    position: "Trainer",
                    department: "Schulung",
                    about: "Ich bin Trainer für verschiedene Schulungsthemen.",
                    phone: "+49 987 654321",
                    points: 850,
                    completedCourses: 8,
                    activeCourses: 1,
                    averageGrade: 1.5,
                    status: "active"
                },
                {
                    id: 3,
                    firstName: "Thomas",
                    lastName: "Müller",
                    email: "thomas@example.com",
                    password: "password123",
                    avatar: "https://randomuser.me/api/portraits/men/68.jpg",
                    role: "user",
                    position: "Mitarbeiter",
                    department: "Vertrieb",
                    about: "Ich arbeite im Vertrieb und nehme an Schulungen teil.",
                    phone: "+49 555 123456",
                    points: 600,
                    completedCourses: 3,
                    activeCourses: 2,
                    averageGrade: 2.0,
                    status: "active"
                }
            ],
            courses: [
                {
                    id: 1,
                    name: "Einführung in HTML und CSS",
                    category: "IT & Software",
                    description: "Lernen Sie die Grundlagen von HTML und CSS, um moderne Webseiten zu erstellen. Dieser Kurs deckt alle wesentlichen Konzepte ab, die Sie benötigen, um mit der Webentwicklung zu beginnen.",
                    image: "https://images.unsplash.com/photo-1547658719-da2b51169166?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                    duration: 8,
                    level: "Anfänger",
                    students: 125,
                    progress: 65,
                    modules: [
                        { id: 1, name: "HTML Grundlagen", type: "video", duration: 45, completed: true },
                        { id: 2, name: "CSS Grundlagen", type: "video", duration: 60, completed: true },
                        { id: 3, name: "Responsive Design", type: "document", duration: 30, completed: false },
                        { id: 4, name: "CSS Flexbox", type: "video", duration: 45, completed: false },
                        { id: 5, name: "Abschlussprüfung", type: "quiz", duration: 30, completed: false }
                    ],
                    quiz: {
                        title: "Prüfung: Einführung in HTML und CSS",
                        description: "Beantworten Sie alle Fragen, um den Kurs abzuschließen und Ihr Zertifikat zu erhalten.",
                        passingScore: 70,
                        questions: [
                            {
                                id: 1,
                                question: "Wofür steht HTML?",
                                type: "single",
                                options: [
                                    { text: "Hyper Text Markup Language", correct: true },
                                    { text: "Hyperlinks and Text Markup Language", correct: false },
                                    { text: "Home Tool Markup Language", correct: false }
                                ],
                                points: 1
                            },
                            {
                                id: 2,
                                question: "Welches Element wird verwendet, um einen Link zu erstellen?",
                                type: "single",
                                options: [
                                    { text: "<link>", correct: false },
                                    { text: "<a>", correct: true },
                                    { text: "<href>", correct: false }
                                ],
                                points: 1
                            },
                            {
                                id: 3,
                                question: "Welche dieser Eigenschaften werden für das Box-Modell in CSS verwendet?",
                                type: "multiple",
                                options: [
                                    { text: "margin", correct: true },
                                    { text: "padding", correct: true },
                                    { text: "border", correct: true },
                                    { text: "color", correct: false }
                                ],
                                points: 2
                            },
                            {
                                id: 4,
                                question: "Welche CSS-Eigenschaft wird verwendet, um die Textfarbe zu ändern?",
                                type: "single",
                                options: [
                                    { text: "text-color", correct: false },
                                    { text: "font-color", correct: false },
                                    { text: "color", correct: true }
                                ],
                                points: 1
                            }
                        ]
                    }
                },
                {
                    id: 2,
                    name: "JavaScript für Anfänger",
                    category: "IT & Software",
                    description: "Erlernen Sie die Grundlagen von JavaScript, der Programmiersprache des Webs. Dieser Kurs führt Sie in die wichtigsten Konzepte ein, die Sie benötigen, um interaktive Webseiten zu erstellen.",
                    image: "https://images.unsplash.com/photo-1579468118864-1b9ea3c0db4a?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                    duration: 12,
                    level: "Anfänger",
                    students: 89,
                    progress: 30,
                    modules: [
                        { id: 1, name: "Einführung in JavaScript", type: "video", duration: 45, completed: true },
                        { id: 2, name: "Variablen und Datentypen", type: "video", duration: 60, completed: true },
                        { id: 3, name: "Funktionen", type: "document", duration: 30, completed: false },
                        { id: 4, name: "DOM Manipulation", type: "video", duration: 45, completed: false },
                        { id: 5, name: "Abschlussprüfung", type: "quiz", duration: 30, completed: false }
                    ]
                },
                {
                    id: 3,
                    name: "Projektmanagement Grundlagen",
                    category: "Business",
                    description: "Lernen Sie die Grundlagen des Projektmanagements kennen und wie Sie Projekte effektiv planen, durchführen und kontrollieren können.",
                    image: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                    duration: 10,
                    level: "Mittelstufe",
                    students: 64,
                    progress: 0,
                    modules: [
                        { id: 1, name: "Einführung ins Projektmanagement", type: "video", duration: 45, completed: false },
                        { id: 2, name: "Projektplanung", type: "video", duration: 60, completed: false },
                        { id: 3, name: "Projektdurchführung", type: "document", duration: 30, completed: false },
                        { id: 4, name: "Projektcontrolling", type: "video", duration: 45, completed: false },
                        { id: 5, name: "Abschlussprüfung", type: "quiz", duration: 30, completed: false }
                    ]
                },
                {
                    id: 4,
                    name: "UX/UI Design Grundlagen",
                    category: "Design",
                    description: "Entdecken Sie die Prinzipien des User Experience und User Interface Designs und lernen Sie, wie Sie benutzerfreundliche digitale Produkte erstellen.",
                    image: "https://images.unsplash.com/photo-1551650975-87deedd944c3?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                    duration: 8,
                    level: "Anfänger",
                    students: 42,
                    progress: 100,
                    modules: [
                        { id: 1, name: "Was ist UX/UI Design?", type: "video", duration: 45, completed: true },
                        { id: 2, name: "Nutzerforschung", type: "video", duration: 60, completed: true },
                        { id: 3, name: "Wireframing", type: "document", duration: 30, completed: true },
                        { id: 4, name: "Prototyping", type: "video", duration: 45, completed: true },
                        { id: 5, name: "Abschlussprüfung", type: "quiz", duration: 30, completed: true }
                    ]
                }
            ],
            certificates: [
                {
                    id: 1,
                    userId: 1,
                    courseId: 4,
                    courseName: "UX/UI Design Grundlagen",
                    date: "2023-03-15",
                    score: 92,
                    grade: "Sehr gut"
                },
                {
                    id: 2,
                    userId: 1,
                    courseId: 5,
                    courseName: "Digitale Marketingstrategien",
                    date: "2023-02-10",
                    score: 85,
                    grade: "Gut"
                },
                {
                    id: 3,
                    userId: 1,
                    courseId: 6,
                    courseName: "Agile Methoden",
                    date: "2023-01-20",
                    score: 78,
                    grade: "Befriedigend"
                }
            ],
            adminStats: {
                users: 3,
                courses: 4,
                certificates: 3,
                activity: 78,
                completionRate: 78,
                averageGrade: 1.8,
                averageTime: 4.2
            },
            activities: [
                {
                    user: "Anna Schmidt",
                    action: "hat einen neuen Kurs erstellt",
                    course: "Advanced JavaScript",
                    time: "Vor 10 Minuten"
                },
                {
                    user: "Thomas Müller",
                    action: "hat eine Prüfung abgeschlossen",
                    course: "Projektmanagement Grundlagen",
                    time: "Vor 25 Minuten"
                },
                {
                    user: "Julia Fischer",
                    action: "hat sich für einen Kurs angemeldet",
                    course: "UX/UI Design Grundlagen",
                    time: "Vor 1 Stunde"
                },
                {
                    user: "Max Mustermann",
                    action: "hat ein Zertifikat erhalten",
                    course: "JavaScript für Anfänger",
                    time: "Vor 2 Stunden"
                }
            ],
            systemSettings: {
                name: "Schulungstool",
                defaultRole: "user",
                passingScore: 70,
                logo: "https://via.placeholder.com/150x80?text=SCHULUNGSTOOL"
            }
        };

        // Current state of the application
        let currentState = {
            currentUser: null,
            currentPage: 'dashboard',
            currentCourse: null,
            currentQuiz: null,
            currentQuestionIndex: 0,
            userAnswers: {},
            adminSection: 'dashboard',
            isAdmin: false,
            isLoggedIn: false,
            editingCourseId: null
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Set up event listeners
            document.getElementById('dropdownMenuButton')?.addEventListener('click', toggleDropdown);
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.dropdown')) {
                    const dropdown = document.getElementById('dropdownMenu');
                    if (dropdown) dropdown.classList.remove('show');
                }
            });
            
            // Form submissions
            document.getElementById('login-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                login();
            });
            
            document.getElementById('profile-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                saveProfile();
            });
            
            document.getElementById('password-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                changePassword();
            });
            
            document.getElementById('add-user-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewUser();
            });
            
            document.getElementById('add-course-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewCourse();
            });
            
            document.getElementById('add-module-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewModule();
            });
            
            document.getElementById('add-question-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewQuestion();
            });
            
            // Quiz navigation
            document.getElementById('prev-question-btn')?.addEventListener('click', showPreviousQuestion);
            document.getElementById('next-question-btn')?.addEventListener('click', showNextQuestion);
            document.getElementById('finish-quiz-btn')?.addEventListener('click', finishQuiz);
            
            // Module type change
            document.getElementById('module-type')?.addEventListener('change', function() {
                const type = this.value;
                document.getElementById('module-video-url').style.display = type === 'video' ? 'block' : 'none';
                document.getElementById('module-file-upload').style.display = type === 'document' || type === 'assignment' ? 'block' : 'none';
                document.getElementById('module-quiz-options').style.display = type === 'quiz' ? 'block' : 'none';
            });

            // Logo upload
            document.getElementById('logo-upload')?.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        // Update logo in system settings
                        sampleData.systemSettings.logo = event.target.result;
                        
                        // Update logo preview in settings
                        document.getElementById('login-logo-img').src = event.target.result;
                        document.getElementById('header-logo-img').src = event.target.result;
                        document.getElementById('certificate-logo-img').src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Course image upload
            document.getElementById('course-image')?.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        // This would be saved when the course is created
                        document.getElementById('course-detail-image').style.backgroundImage = `url('${event.target.result}')`;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Profile image upload
            document.getElementById('profile-avatar-input')?.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        document.getElementById('profile-avatar').src = event.target.result;
                        document.getElementById('user-avatar').src = event.target.result;
                        if (currentState.currentUser) {
                            currentState.currentUser.avatar = event.target.result;
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Initialize system settings
            updateSystemSettingsUI();
        });

        // Update system settings UI
        function updateSystemSettingsUI() {
            document.getElementById('system-name').value = sampleData.systemSettings.name;
            document.getElementById('default-role').value = sampleData.systemSettings.defaultRole;
            document.getElementById('passing-score').value = sampleData.systemSettings.passingScore;
            
            // Update logo images
            document.getElementById('login-logo-img').src = sampleData.systemSettings.logo;
            document.getElementById('header-logo-img').src = sampleData.systemSettings.logo;
            document.getElementById('certificate-logo-img').src = sampleData.systemSettings.logo;
            
            // Update system name
            document.getElementById('header-system-name').textContent = sampleData.systemSettings.name;
            document.getElementById('footer-system-name').textContent = sampleData.systemSettings.name;
        }

        // Save system settings
        function saveSystemSettings() {
            sampleData.systemSettings.name = document.getElementById('system-name').value;
            sampleData.systemSettings.defaultRole = document.getElementById('default-role').value;
            sampleData.systemSettings.passingScore = parseInt(document.getElementById('passing-score').value);
            
            // Update UI
            updateSystemSettingsUI();
            
            alert('Systemeinstellungen erfolgreich gespeichert!');
        }

        // Reset system settings
        function resetSettings() {
            if (confirm('Möchten Sie die Einstellungen wirklich auf die Standardwerte zurücksetzen?')) {
                sampleData.systemSettings = {
                    name: "Schulungstool",
                    defaultRole: "user",
                    passingScore: 70,
                    logo: "https://via.placeholder.com/150x80?text=SCHULUNGSTOOL"
                };
                
                updateSystemSettingsUI();
                alert('Einstellungen wurden zurückgesetzt!');
            }
        }

        // Login function
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Find user in sample data
            const user = sampleData.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                // Set current user
                currentState.currentUser = user;
                currentState.isLoggedIn = true;
                
                // Check if user is admin
                checkAdminStatus();
                
                // Load initial data
                loadDashboard();
                loadAllCourses();
                loadCertificates();
                loadAdminData();
                loadProfileData();
                
                // Show dashboard
                showPage('dashboard');
                
                // Hide login page and show app
                document.getElementById('login-page').style.display = 'none';
                document.getElementById('app-container').style.display = 'block';
                
                // Update user info in header
                updateUserHeader();
            } else {
                alert('Ungültige Anmeldedaten. Bitte versuchen Sie es erneut.');
            }
        }

        // Logout function
        function logout() {
            // Reset current user
            currentState.currentUser = null;
            currentState.isLoggedIn = false;
            currentState.isAdmin = false;
            
            // Show login page and hide app
            document.getElementById('login-page').style.display = 'flex';
            document.getElementById('app-container').style.display = 'none';
            
            // Reset login form
            document.getElementById('login-form').reset();
            
            // Show logout message
            alert('Sie wurden erfolgreich abgemeldet.');
        }

        // Update user info in header
        function updateUserHeader() {
            if (currentState.currentUser) {
                document.getElementById('username').textContent = `${currentState.currentUser.firstName} ${currentState.currentUser.lastName}`;
                document.getElementById('user-avatar').src = currentState.currentUser.avatar;
            }
        }

        // Check if current user is admin
        function checkAdminStatus() {
            currentState.isAdmin = currentState.currentUser?.role === 'admin';
            
            if (currentState.isAdmin) {
                document.querySelector('.admin-link').style.display = 'block';
                document.querySelector('.admin-controls').style.display = 'block';
            } else {
                document.querySelector('.admin-link').style.display = 'none';
                document.querySelector('.admin-controls').style.display = 'none';
            }
        }

        // Toggle dropdown menu
        function toggleDropdown() {
            document.getElementById('dropdownMenu').classList.toggle('show');
        }

        // Show a specific page
        function showPage(page) {
            if (!currentState.isLoggedIn && page !== 'login') {
                return;
            }
            
            // Hide all pages
            document.querySelectorAll('.page').forEach(el => {
                el.style.display = 'none';
            });
            
            // Show the requested page
            document.getElementById(`${page}-page`).style.display = 'block';
            currentState.currentPage = page;
            
            // Special handling for certain pages
            if (page === 'dashboard') {
                loadDashboard();
            } else if (page === 'courses') {
                loadAllCourses();
            } else if (page === 'certificates') {
                loadCertificates();
            } else if (page === 'admin') {
                showAdminSection(currentState.adminSection);
            } else if (page === 'profile') {
                loadProfileData();
            }
        }

        // Show a specific admin section
        function showAdminSection(section) {
            // Hide all admin sections
            document.querySelectorAll('#admin-content > div').forEach(el => {
                el.style.display = 'none';
            });
            
            // Show the requested section
            document.getElementById(`admin-${section}-section`).style.display = 'block';
            currentState.adminSection = section;
            
            // Update active nav link
            document.querySelectorAll('.admin-nav a').forEach(el => {
                el.classList.remove('active');
            });
            
            document.querySelector(`.admin-nav a[onclick="showAdminSection('${section}')"]`).classList.add('active');
        }

        // Load dashboard data
        function loadDashboard() {
            if (!currentState.currentUser) return;
            
            // Update user info
            updateUserHeader();
            
            // Count courses by status for current user
            const activeCourses = sampleData.courses.filter(c => c.progress > 0 && c.progress < 100).length;
            const completedCourses = sampleData.courses.filter(c => c.progress === 100).length;
            const inProgressCourses = sampleData.courses.filter(c => c.progress > 0).length;
            
            // Update counts
            document.getElementById('active-courses-count').textContent = activeCourses;
            document.getElementById('completed-courses-count').textContent = completedCourses;
            document.getElementById('inprogress-courses-count').textContent = inProgressCourses;
            document.getElementById('points-count').textContent = currentState.currentUser.points.toLocaleString();
            
            // Load current courses
            const currentCoursesContainer = document.getElementById('current-courses');
            currentCoursesContainer.innerHTML = '';
            
            const currentCourses = sampleData.courses.filter(c => c.progress > 0 && c.progress < 100);
            
            if (currentCourses.length === 0) {
                currentCoursesContainer.innerHTML = `
                    <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <i class="fas fa-book-open" style="font-size: 50px; color: var(--gray-light); margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 10px;">Keine aktiven Kurse</h3>
                        <p style="color: var(--gray); margin-bottom: 20px;">Sie haben derzeit keine aktiven Kurse. Durchsuchen Sie unseren Katalog, um einen neuen Kurs zu beginnen.</p>
                        <button class="btn btn-primary" onclick="showPage('courses')">
                            <i class="fas fa-search"></i> Kurse durchsuchen
                        </button>
                    </div>
                `;
            } else {
                currentCourses.forEach(course => {
                    const courseCard = createCourseCard(course);
                    currentCoursesContainer.appendChild(courseCard);
                });
            }
        }

        // Load all courses
        function loadAllCourses() {
            const allCoursesContainer = document.getElementById('all-courses');
            allCoursesContainer.innerHTML = '';
            
            sampleData.courses.forEach(course => {
                const courseCard = createCourseCard(course);
                allCoursesContainer.appendChild(courseCard);
            });
        }

        // Create a course card element
        function createCourseCard(course) {
            const courseCard = document.createElement('div');
            courseCard.className = 'course-card';
            
            let progressBar = '';
            let progressText = '';
            let actionButton = '';
            
            if (course.progress === 0) {
                actionButton = `<button class="btn btn-primary btn-sm" onclick="startCourse(${course.id})">Starten</button>`;
            } else if (course.progress === 100) {
                progressBar = `
                    <div class="course-progress">
                        <div class="d-flex justify-content-between mb-10">
                            <span>Abgeschlossen</span>
                            <span>100%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%; background: var(--success);"></div>
                        </div>
                    </div>
                `;
                actionButton = `<button class="btn btn-outline btn-sm" onclick="viewCertificate(${course.id})">Zertifikat anzeigen</button>`;
            } else {
                progressBar = `
                    <div class="course-progress">
                        <div class="d-flex justify-content-between mb-10">
                            <span>Fortschritt</span>
                            <span>${course.progress}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${course.progress}%;"></div>
                        </div>
                    </div>
                `;
                actionButton = `<button class="btn btn-primary btn-sm" onclick="continueCourse(${course.id})">Fortsetzen</button>`;
            }
            
            courseCard.innerHTML = `
                <div class="course-image" style="background-image: url('${course.image}');"></div>
                <div class="course-content">
                    <span class="course-category">${course.category}</span>
                    <h3 class="course-title">${course.name}</h3>
                    <p class="course-description">${course.description}</p>
                    
                    <div class="course-meta">
                        <div class="course-meta-item">
                            <i class="fas fa-clock"></i> ${course.duration} Stunden
                        </div>
                        <div class="course-meta-item">
                            <i class="fas fa-layer-group"></i> ${course.level}
                        </div>
                        <div class="course-meta-item">
                            <i class="fas fa-users"></i> ${course.students} Teilnehmer
                        </div>
                    </div>
                    
                    ${progressBar}
                    
                    <div class="course-actions">
                        <button class="btn btn-outline btn-sm" onclick="viewCourseDetails(${course.id})">
                            <i class="fas fa-info-circle"></i> Details
                        </button>
                        ${actionButton}
                    </div>
                </div>
            `;
            
            return courseCard;
        }

        // Start a new course
        function startCourse(courseId) {
            const course = sampleData.courses.find(c => c.id === courseId);
            if (course) {
                course.progress = 5; // Just started
                course.students += 1;
                loadAllCourses();
                loadDashboard();
                viewCourseDetails(courseId);
            }
        }

        // Continue a course
        function continueCourse(courseId) {
            viewCourseDetails(courseId);
        }

        // View course details
        function viewCourseDetails(courseId) {
            const course = sampleData.courses.find(c => c.id === courseId);
            if (course) {
                currentState.currentCourse = course;
                
                // Update course details
                document.getElementById('course-detail-title').innerHTML = `<i class="fas fa-book"></i> ${course.name}`;
                document.getElementById('course-detail-name').textContent = course.name;
                document.getElementById('course-detail-category').textContent = course.category;
                document.getElementById('course-detail-description').textContent = course.description;
                document.getElementById('course-detail-duration').textContent = course.duration;
                document.getElementById('course-detail-level').textContent = course.level;
                document.getElementById('course-detail-students').textContent = course.students;
                document.getElementById('course-detail-image').style.backgroundImage = `url('${course.image}')`;
                
                // Update progress
                document.getElementById('course-progress-percent').textContent = `${course.progress}%`;
                document.getElementById('course-progress-bar').style.width = `${course.progress}%`;
                
                // Show/hide progress section
                document.getElementById('course-progress-section').style.display = course.progress > 0 ? 'block' : 'none';
                
                // Update actions
                const actionsContainer = document.getElementById('course-actions');
                actionsContainer.innerHTML = '';
                
                if (course.progress === 100) {
                    actionsContainer.innerHTML = `
                        <button class="btn btn-primary" onclick="viewCertificate(${course.id})">
                            <i class="fas fa-certificate"></i> Zertifikat anzeigen
                        </button>
                    `;
                } else if (course.progress > 0) {
                    actionsContainer.innerHTML = `
                        <button class="btn btn-primary" onclick="continueCourseModule(${course.id})">
                            <i class="fas fa-play"></i> Kurs fortsetzen
                        </button>
                    `;
                } else {
                    actionsContainer.innerHTML = `
                        <button class="btn btn-primary" onclick="startCourse(${course.id})">
                            <i class="fas fa-play"></i> Kurs starten
                        </button>
                    `;
                }
                
                // Load modules
                const modulesContainer = document.getElementById('course-modules');
                modulesContainer.innerHTML = '';
                
                if (course.modules && course.modules.length > 0) {
                    course.modules.forEach(module => {
                        const moduleEl = document.createElement('div');
                        moduleEl.className = 'd-flex justify-content-between align-items-center mb-15';
                        
                        const moduleInfo = document.createElement('div');
                        moduleInfo.className = 'd-flex align-items-center';
                        
                        let icon = '';
                        if (module.type === 'video') icon = '<i class="fas fa-video" style="color: var(--danger); margin-right: 10px;"></i>';
                        if (module.type === 'document') icon = '<i class="fas fa-file-alt" style="color: var(--primary); margin-right: 10px;"></i>';
                        if (module.type === 'quiz') icon = '<i class="fas fa-question-circle" style="color: var(--warning); margin-right: 10px;"></i>';
                        if (module.type === 'assignment') icon = '<i class="fas fa-tasks" style="color: var(--success); margin-right: 10px;"></i>';
                        
                        let status = '';
                        if (module.completed) status = '<i class="fas fa-check-circle" style="color: var(--success); margin-left: 10px;"></i>';
                        
                        moduleInfo.innerHTML = `
                            ${icon}
                            <div>
                                <strong>${module.name}</strong>
                                <div style="font-size: 13px; color: var(--gray);">${module.duration} Minuten ${status}</div>
                            </div>
                        `;
                        
                        moduleEl.appendChild(moduleInfo);
                        
                        if (currentState.isAdmin) {
                            const moduleActions = document.createElement('div');
                            moduleActions.innerHTML = `
                                <button class="btn btn-outline btn-sm btn-icon" onclick="editModule(${module.id})">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-outline btn-sm btn-icon" onclick="deleteModule(${module.id})" style="margin-left: 5px;">
                                    <i class="fas fa-trash"></i>
                                </button>
                            `;
                            moduleEl.appendChild(moduleActions);
                        }
                        
                        modulesContainer.appendChild(moduleEl);
                    });
                    
                    if (currentState.isAdmin) {
                        const addModuleBtn = document.createElement('button');
                        addModuleBtn.className = 'btn btn-primary btn-sm';
                        addModuleBtn.innerHTML = '<i class="fas fa-plus"></i> Modul hinzufügen';
                        addModuleBtn.onclick = showAddModuleModal;
                        modulesContainer.appendChild(addModuleBtn);
                    }
                } else {
                    modulesContainer.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: var(--gray);">
                            <i class="fas fa-book-open" style="font-size: 30px; margin-bottom: 10px;"></i>
                            <p>Keine Module verfügbar</p>
                        </div>
                    `;
                    
                    if (currentState.isAdmin) {
                        const addModuleBtn = document.createElement('button');
                        addModuleBtn.className = 'btn btn-primary btn-sm';
                        addModuleBtn.innerHTML = '<i class="fas fa-plus"></i> Modul hinzufügen';
                        addModuleBtn.onclick = showAddModuleModal;
                        modulesContainer.appendChild(addModuleBtn);
                    }
                }
                
                // Show course detail page
                showPage('course-detail');
            }
        }

        // Continue with a course module
        function continueCourseModule(courseId) {
            const course = sampleData.courses.find(c => c.id === courseId);
            if (course) {
                // Find first incomplete module
                const incompleteModule = course.modules.find(m => !m.completed);
                
                if (incompleteModule) {
                    if (incompleteModule.type === 'quiz') {
                        startQuiz(course);
                    } else {
                        alert(`Modul "${incompleteModule.name}" wird gestartet...`);
                        // In a real app, this would open the module content
                        incompleteModule.completed = true;
                        
                        // Update progress
                        const completedModules = course.modules.filter(m => m.completed).length;
                        course.progress = Math.round((completedModules / course.modules.length) * 100);
                        
                        // Refresh views
                        loadAllCourses();
                        loadDashboard();
                        viewCourseDetails(courseId);
                    }
                } else {
                    // All modules completed, show quiz if available
                    const quizModule = course.modules.find(m => m.type === 'quiz');
                    if (quizModule && !quizModule.completed) {
                        startQuiz(course);
                    } else {
                        alert('Kurs bereits abgeschlossen!');
                    }
                }
            }
        }

        // Start a quiz
        function startQuiz(course) {
            currentState.currentQuiz = course.quiz;
            currentState.currentQuestionIndex = 0;
            currentState.userAnswers = {};
            
            // Set quiz info
            document.getElementById('quiz-title').textContent = course.quiz.title;
            document.getElementById('quiz-description').textContent = course.quiz.description;
            
            // Show first question
            showQuestion(currentState.currentQuestionIndex);
            
            // Show quiz page
            showPage('quiz');
        }

        // Show a specific quiz question
        function showQuestion(index) {
            if (!currentState.currentQuiz || !currentState.currentQuiz.questions || 
                index < 0 || index >= currentState.currentQuiz.questions.length) {
                return;
            }
            
            const question = currentState.currentQuiz.questions[index];
            const questionsContainer = document.getElementById('quiz-questions');
            questionsContainer.innerHTML = '';
            
            // Create question card
            const questionCard = document.createElement('div');
            questionCard.className = 'question-card';
            
            // Question text
            questionCard.innerHTML = `
                <h3 class="question-text">Frage ${index + 1}: ${question.question}</h3>
                <ul class="options-list">
            `;
            
            // Add options
            question.options.forEach((option, i) => {
                const optionItem = document.createElement('li');
                optionItem.className = 'option-item';
                
                const optionId = `q${index}-o${i}`;
                let inputElement = '';
                
                if (question.type === 'multiple') {
                    inputElement = `
                        <input type="checkbox" id="${optionId}" class="option-input" 
                               name="q${index}" value="${i}" 
                               ${currentState.userAnswers[index] && currentState.userAnswers[index].includes(i) ? 'checked' : ''}>
                    `;
                } else {
                    inputElement = `
                        <input type="radio" id="${optionId}" class="option-input" 
                               name="q${index}" value="${i}" 
                               ${currentState.userAnswers[index] && currentState.userAnswers[index].includes(i) ? 'checked' : ''}>
                    `;
                }
                
                optionItem.innerHTML = `
                    <label for="${optionId}" class="option-label">
                        ${inputElement}
                        ${option.text}
                    </label>
                `;
                
                questionCard.querySelector('.options-list').appendChild(optionItem);
            });
            
            questionsContainer.appendChild(questionCard);
            
            // Update progress
            const progressPercent = ((index + 1) / currentState.currentQuiz.questions.length) * 100;
            document.getElementById('quiz-progress-bar').style.width = `${progressPercent}%`;
            document.getElementById('quiz-progress-text').textContent = `${index + 1}/${currentState.currentQuiz.questions.length}`;
            
            // Update navigation buttons
            document.getElementById('prev-question-btn').disabled = index === 0;
            document.getElementById('next-question-btn').style.display = 
                index < currentState.currentQuiz.questions.length - 1 ? 'block' : 'none';
            document.getElementById('finish-quiz-btn').style.display = 
                index === currentState.currentQuiz.questions.length - 1 ? 'block' : 'none';
        }

        // Save answer and show next question
        function showNextQuestion() {
            saveCurrentAnswer();
            
            if (currentState.currentQuestionIndex < currentState.currentQuiz.questions.length - 1) {
                currentState.currentQuestionIndex++;
                showQuestion(currentState.currentQuestionIndex);
            }
        }

        // Show previous question
        function showPreviousQuestion() {
            if (currentState.currentQuestionIndex > 0) {
                currentState.currentQuestionIndex--;
                showQuestion(currentState.currentQuestionIndex);
            }
        }

        // Save the current answer
        function saveCurrentAnswer() {
            const question = currentState.currentQuiz.questions[currentState.currentQuestionIndex];
            const selectedOptions = [];
            
            if (question.type === 'multiple') {
                document.querySelectorAll(`input[name="q${currentState.currentQuestionIndex}"]:checked`).forEach(input => {
                    selectedOptions.push(parseInt(input.value));
                });
            } else {
                const selectedInput = document.querySelector(`input[name="q${currentState.currentQuestionIndex}"]:checked`);
                if (selectedInput) {
                    selectedOptions.push(parseInt(selectedInput.value));
                }
            }
            
            if (selectedOptions.length > 0) {
                currentState.userAnswers[currentState.currentQuestionIndex] = selectedOptions;
            }
        }

        // Finish the quiz and show results
        function finishQuiz() {
            saveCurrentAnswer();
            
            // Calculate score
            let totalScore = 0;
            let maxScore = 0;
            
            currentState.currentQuiz.questions.forEach((question, index) => {
                maxScore += question.points;
                
                if (currentState.userAnswers[index]) {
                    const correctAnswers = question.options
                        .map((opt, i) => opt.correct ? i : -1)
                        .filter(i => i !== -1);
                    
                    const userAnswers = currentState.userAnswers[index];
                    
                    // For single-choice questions
                    if (question.type === 'single') {
                        if (correctAnswers.length === 1 && userAnswers.length === 1 && 
                            correctAnswers[0] === userAnswers[0]) {
                            totalScore += question.points;
                        }
                    }
                    // For multiple-choice questions
                    else if (question.type === 'multiple') {
                        const correctCount = userAnswers.filter(ans => 
                            question.options[ans].correct).length;
                        const incorrectCount = userAnswers.filter(ans => 
                            !question.options[ans].correct).length;
                        
                        // Partial credit if no incorrect answers
                        if (incorrectCount === 0 && correctCount > 0) {
                            totalScore += (correctCount / correctAnswers.length) * question.points;
                        }
                    }
                }
            });
            
            const percentage = Math.round((totalScore / maxScore) * 100);
            const passingScore = currentState.currentQuiz.passingScore || sampleData.systemSettings.passingScore;
            const passed = percentage >= passingScore;
            
            // Update course progress if passed
            if (passed && currentState.currentCourse) {
                // Mark quiz module as completed
                const quizModule = currentState.currentCourse.modules.find(m => m.type === 'quiz');
                if (quizModule) {
                    quizModule.completed = true;
                }
                
                // Update course progress to 100%
                currentState.currentCourse.progress = 100;
                
                // Create certificate
                const certificateId = sampleData.certificates.length + 1;
                const certificateDate = new Date().toISOString().split('T')[0];
                
                sampleData.certificates.push({
                    id: certificateId,
                    userId: currentState.currentUser.id,
                    courseId: currentState.currentCourse.id,
                    courseName: currentState.currentCourse.name,
                    date: certificateDate,
                    score: percentage,
                    grade: getGrade(percentage)
                });
                
                // Update user points
                currentState.currentUser.points += Math.round(percentage * 10);
                currentState.currentUser.completedCourses += 1;
                
                // Update admin stats
                sampleData.adminStats.certificates += 1;
                
                // Show certificate
                viewCertificate(currentState.currentCourse.id);
            } else {
                alert(`Sie haben die Prüfung mit ${percentage}% nicht bestanden. Die Mindestpunktzahl beträgt ${passingScore}%. Bitte versuchen Sie es erneut.`);
                showPage('course-detail');
            }
        }

        // Get grade based on percentage
        function getGrade(percentage) {
            if (percentage >= 90) return "Sehr gut";
            if (percentage >= 80) return "Gut";
            if (percentage >= 70) return "Befriedigend";
            if (percentage >= 60) return "Ausreichend";
            return "Nicht bestanden";
        }

        // Back to course detail from quiz
        function backToCourseDetail() {
            if (currentState.currentCourse) {
                showPage('course-detail');
            } else {
                showPage('courses');
            }
        }

        // Load certificates
        function loadCertificates() {
            const certificatesContainer = document.getElementById('certificates-list');
            certificatesContainer.innerHTML = '';
            
            const userCertificates = sampleData.certificates.filter(c => c.userId === currentState.currentUser.id);
            
            if (userCertificates.length === 0) {
                certificatesContainer.innerHTML = `
                    <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <i class="fas fa-certificate" style="font-size: 50px; color: var(--gray-light); margin-bottom: 20px;"></i>
                        <h3 style="margin-bottom: 10px;">Keine Zertifikate</h3>
                        <p style="color: var(--gray); margin-bottom: 20px;">Sie haben noch keine Kurse abgeschlossen. Schließen Sie einen Kurs ab, um Ihr erstes Zertifikat zu erhalten.</p>
                        <button class="btn btn-primary" onclick="showPage('courses')">
                            <i class="fas fa-book"></i> Kurse durchsuchen
                        </button>
                    </div>
                `;
            } else {
                userCertificates.forEach(cert => {
                    const course = sampleData.courses.find(c => c.id === cert.courseId);
                    
                    const certCard = document.createElement('div');
                    certCard.className = 'course-card';
                    certCard.style.cursor = 'pointer';
                    certCard.onclick = () => viewCertificate(cert.courseId);
                    
                    certCard.innerHTML = `
                        <div class="course-image" style="background-image: url('${course ? course.image : ''}');"></div>
                        <div class="course-content">
                            <span class="course-category">Zertifikat</span>
                            <h3 class="course-title">${cert.courseName}</h3>
                            
                            <div class="course-meta">
                                <div class="course-meta-item">
                                    <i class="fas fa-calendar-alt"></i> ${formatDate(cert.date)}
                                </div>
                                <div class="course-meta-item">
                                    <i class="fas fa-percentage"></i> ${cert.score}% erreicht
                                </div>
                                <div class="course-meta-item">
                                    <i class="fas fa-star"></i> Note: ${cert.grade}
                                </div>
                            </div>
                            
                            <div class="course-actions">
                                <button class="btn btn-primary btn-sm w-100" onclick="event.stopPropagation(); viewCertificate(${cert.courseId})">
                                    <i class="fas fa-eye"></i> Anzeigen
                                </button>
                            </div>
                        </div>
                    `;
                    
                    certificatesContainer.appendChild(certCard);
                });
            }
        }

        // View certificate
        function viewCertificate(courseId) {
            const cert = sampleData.certificates.find(c => c.courseId === courseId && c.userId === currentState.currentUser.id);
            if (cert) {
                document.getElementById('certificate-user-name').textContent = 
                    `${currentState.currentUser.firstName} ${currentState.currentUser.lastName}`;
                document.getElementById('certificate-course-name').textContent = cert.courseName;
                document.getElementById('certificate-date').textContent = `Ausgestellt am: ${formatDate(cert.date)}`;
                
                showPage('certificate-detail');
            }
        }

        // Format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('de-DE', options);
        }

        // Print certificate
        function printCertificate() {
            const printContents = document.getElementById('certificate-container').innerHTML;
            const originalContents = document.body.innerHTML;
            
            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
            
            // Re-initialize the page
            showPage('certificate-detail');
        }

        // Load admin data
        function loadAdminData() {
            if (!currentState.isAdmin) return;
            
            // Update stats
            document.getElementById('admin-users-count').textContent = sampleData.adminStats.users;
            document.getElementById('admin-courses-count').textContent = sampleData.adminStats.courses;
            document.getElementById('admin-certificates-count').textContent = sampleData.adminStats.certificates;
            document.getElementById('admin-activity-count').textContent = `${sampleData.adminStats.activity}%`;
            document.getElementById('completion-rate').textContent = `${sampleData.adminStats.completionRate}%`;
            document.getElementById('average-grade').textContent = sampleData.adminStats.averageGrade;
            document.getElementById('average-time').textContent = sampleData.adminStats.averageTime;
            
            // Load activities
            const activitiesContainer = document.getElementById('admin-activities');
            activitiesContainer.innerHTML = '';
            
            sampleData.activities.forEach(activity => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${activity.user}</td>
                    <td>${activity.action}</td>
                    <td>${activity.course}</td>
                    <td>${activity.time}</td>
                `;
                activitiesContainer.appendChild(row);
            });
            
            // Load users
            const usersContainer = document.getElementById('admin-users-list');
            usersContainer.innerHTML = '';
            
            sampleData.users.forEach(user => {
                const row = document.createElement('tr');
                
                let roleBadge = '';
                if (user.role === 'admin') roleBadge = '<span class="badge badge-danger">Admin</span>';
                if (user.role === 'trainer') roleBadge = '<span class="badge badge-warning">Trainer</span>';
                if (user.role === 'user') roleBadge = '<span class="badge badge-success">Teilnehmer</span>';
                
                let statusBadge = '';
                if (user.status === 'active') statusBadge = '<span class="badge badge-success">Aktiv</span>';
                if (user.status === 'inactive') statusBadge = '<span class="badge badge-danger">Inaktiv</span>';
                
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.firstName} ${user.lastName}</td>
                    <td>${user.email}</td>
                    <td>${roleBadge}</td>
                    <td>${statusBadge}</td>
                    <td class="actions">
                        <button class="btn btn-outline btn-icon" onclick="editUser(${user.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline btn-icon" onclick="deleteUser(${user.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                usersContainer.appendChild(row);
            });
            
            // Load courses
            const coursesContainer = document.getElementById('admin-courses-list');
            coursesContainer.innerHTML = '';
            
            sampleData.courses.forEach(course => {
                const row = document.createElement('tr');
                
                let statusBadge = '';
                if (course.progress === 0) statusBadge = '<span class="badge badge-warning">Neu</span>';
                if (course.progress > 0 && course.progress < 100) statusBadge = '<span class="badge badge-success">Aktiv</span>';
                if (course.progress === 100) statusBadge = '<span class="badge badge-primary">Abgeschlossen</span>';
                
                row.innerHTML = `
                    <td>${course.id}</td>
                    <td>${course.name}</td>
                    <td>${course.category}</td>
                    <td>${course.students}</td>
                    <td>${statusBadge}</td>
                    <td class="actions">
                        <button class="btn btn-outline btn-icon" onclick="editCourse(${course.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline btn-icon" onclick="deleteCourse(${course.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                coursesContainer.appendChild(row);
            });
            
            // Load certificates
            const certsContainer = document.getElementById('admin-certificates-list');
            certsContainer.innerHTML = '';
            
            sampleData.certificates.forEach(cert => {
                const user = sampleData.users.find(u => u.id === cert.userId);
                const course = sampleData.courses.find(c => c.id === cert.courseId);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${cert.id}</td>
                    <td>${user ? `${user.firstName} ${user.lastName}` : 'Unbekannt'}</td>
                    <td>${course ? course.name : cert.courseName}</td>
                    <td>${formatDate(cert.date)}</td>
                    <td>${cert.grade}</td>
                    <td class="actions">
                        <button class="btn btn-outline btn-icon" onclick="viewCertificateAdmin(${cert.courseId}, ${cert.userId})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-outline btn-icon" onclick="deleteCertificate(${cert.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                certsContainer.appendChild(row);
            });
        }

        // View certificate as admin
        function viewCertificateAdmin(courseId, userId) {
            // In a real app, this would show the certificate in admin view
            alert(`Zertifikat für Kurs ID ${courseId} und Benutzer ID ${userId} wird angezeigt...`);
        }

        // Load profile data
        function loadProfileData() {
            const user = currentState.currentUser;
            if (!user) return;
            
            // Update profile info
            document.getElementById('profile-name').textContent = `${user.firstName} ${user.lastName}`;
            document.getElementById('profile-role').textContent = 
                user.role === 'admin' ? 'Administrator' : 
                user.role === 'trainer' ? 'Trainer' : 'Teilnehmer';
            document.getElementById('profile-email').textContent = user.email;
            document.getElementById('profile-avatar').src = user.avatar;
            
            // Update stats
            document.getElementById('profile-completed-courses').textContent = user.completedCourses;
            document.getElementById('profile-active-courses').textContent = user.activeCourses;
            document.getElementById('profile-points').textContent = user.points.toLocaleString();
            document.getElementById('profile-average-grade').textContent = user.averageGrade;
            
            // Update form fields
            document.getElementById('profile-firstname').value = user.firstName;
            document.getElementById('profile-lastname').value = user.lastName;
            document.getElementById('profile-email-input').value = user.email;
            document.getElementById('profile-phone').value = user.phone;
            document.getElementById('profile-position').value = user.position;
            document.getElementById('profile-department').value = user.department;
            document.getElementById('profile-about').value = user.about;
        }

        // Save profile changes
        function saveProfile() {
            const user = currentState.currentUser;
            
            user.firstName = document.getElementById('profile-firstname').value;
            user.lastName = document.getElementById('profile-lastname').value;
            user.email = document.getElementById('profile-email-input').value;
            user.phone = document.getElementById('profile-phone').value;
            user.position = document.getElementById('profile-position').value;
            user.department = document.getElementById('profile-department').value;
            user.about = document.getElementById('profile-about').value;
            
            // Update displayed name
            document.getElementById('username').textContent = `${user.firstName} ${user.lastName}`;
            document.getElementById('profile-name').textContent = `${user.firstName} ${user.lastName}`;
            
            alert('Profil erfolgreich aktualisiert!');
        }

        // Change password
        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('Bitte füllen Sie alle Felder aus.');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('Die neuen Passwörter stimmen nicht überein.');
                return;
            }
            
            // Verify current password
            if (currentPassword !== currentState.currentUser.password) {
                alert('Das aktuelle Passwort ist falsch.');
                return;
            }
            
            // Update password
            currentState.currentUser.password = newPassword;
            
            alert('Passwort erfolgreich geändert!');
            
            // Clear form
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }

        // Show add user modal
        function showAddUserModal() {
            document.getElementById('add-user-form').reset();
            document.getElementById('add-user-role').value = sampleData.systemSettings.defaultRole;
            openModal('add-user-modal');
        }

        // Add new user
        function addNewUser() {
            const firstName = document.getElementById('add-user-firstname').value;
            const lastName = document.getElementById('add-user-lastname').value;
            const email = document.getElementById('add-user-email').value;
            const role = document.getElementById('add-user-role').value;
            const password = document.getElementById('add-user-password').value;
            const confirmPassword = document.getElementById('add-user-confirm-password').value;
            
            // Validate inputs
            if (!firstName || !lastName || !email || !role || !password || !confirmPassword) {
                alert('Bitte füllen Sie alle Felder aus.');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Die Passwörter stimmen nicht überein.');
                return;
            }
            
            // Check if email already exists
            if (sampleData.users.some(u => u.email === email)) {
                alert('Diese E-Mail-Adresse ist bereits registriert.');
                return;
            }
            
            // Create new user
            const newUser = {
                id: sampleData.users.length + 1,
                firstName,
                lastName,
                email,
                password,
                avatar: "https://randomuser.me/api/portraits/men/" + (Math.floor(Math.random() * 100) + 1) + ".jpg",
                role,
                position: "",
                department: "",
                about: "",
                phone: "",
                points: 0,
                completedCourses: 0,
                activeCourses: 0,
                averageGrade: 0,
                status: "active"
            };
            
            // Add to sample data
            sampleData.users.push(newUser);
            
            // Update admin stats
            sampleData.adminStats.users += 1;
            
            // Close modal
            closeModal('add-user-modal');
            
            // Refresh users list
            loadAdminData();
            
            alert('Benutzer erfolgreich angelegt!');
        }

        // Edit user
        function editUser(userId) {
            const user = sampleData.users.find(u => u.id === userId);
            if (user) {
                // In a real app, you would open a modal with the user data to edit
                alert(`Benutzer ${user.firstName} ${user.lastName} bearbeiten...`);
            }
        }

        // Delete user
        function deleteUser(userId) {
            if (userId === currentState.currentUser.id) {
                alert('Sie können Ihr eigenes Konto nicht löschen.');
                return;
            }
            
            if (confirm('Möchten Sie diesen Benutzer wirklich löschen?')) {
                // Remove user from sample data
                sampleData.users = sampleData.users.filter(u => u.id !== userId);
                
                // Update admin stats
                sampleData.adminStats.users -= 1;
                
                // Refresh users list
                loadAdminData();
                
                alert('Benutzer wurde gelöscht!');
            }
        }

        // Show add course modal
        function showAddCourseModal() {
            document.getElementById('add-course-form').reset();
            document.getElementById('course-category').value = '';
            document.getElementById('course-level').value = 'Anfänger';
            document.getElementById('course-passing-score').value = sampleData.systemSettings.passingScore;
            openModal('add-course-modal');
        }

        // Add new course
        function addNewCourse() {
            const name = document.getElementById('course-name').value;
            const category = document.getElementById('course-category').value;
            const level = document.getElementById('course-level').value;
            const description = document.getElementById('course-description').value;
            const duration = parseInt(document.getElementById('course-duration').value);
            const passingScore = parseInt(document.getElementById('course-passing-score').value);
            
            // Validate inputs
            if (!name || !category || !level || !description || !duration || !passingScore) {
                alert('Bitte füllen Sie alle erforderlichen Felder aus.');
                return;
            }
            
            // Create new course
            const newCourse = {
                id: sampleData.courses.length + 1,
                name,
                category,
                description,
                image: "https://images.unsplash.com/photo-1547658719-da2b51169166?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                duration,
                level,
                students: 0,
                progress: 0,
                modules: [],
                quiz: {
                    title: `Prüfung: ${name}`,
                    description: "Beantworten Sie alle Fragen, um den Kurs abzuschließen und Ihr Zertifikat zu erhalten.",
                    passingScore,
                    questions: []
                }
            };
            
            // Handle image upload if any
            const imageInput = document.getElementById('course-image');
            if (imageInput.files.length > 0) {
                const file = imageInput.files[0];
                const reader = new FileReader();
                reader.onload = function(event) {
                    newCourse.image = event.target.result;
                };
                reader.readAsDataURL(file);
            }
            
            // Add to sample data
            sampleData.courses.push(newCourse);
            
            // Update admin stats
            sampleData.adminStats.courses += 1;
            
            // Close modal
            closeModal('add-course-modal');
            
            // Refresh courses list
            loadAllCourses();
            loadAdminData();
            
            alert('Kurs erfolgreich erstellt!');
        }

        // Edit course
        function editCourse(courseId) {
            const course = sampleData.courses.find(c => c.id === courseId);
            if (course) {
                currentState.editingCourseId = courseId;
                
                // Fill form with course data
                document.getElementById('edit-course-name').value = course.name;
                document.getElementById('edit-course-category').value = course.category;
                document.getElementById('edit-course-level').value = course.level;
                document.getElementById('edit-course-description').value = course.description;
                document.getElementById('edit-course-duration').value = course.duration;
                document.getElementById('edit-course-passing-score').value = course.quiz.passingScore;
                document.getElementById('current-course-image-name').textContent = course.image.substring(course.image.lastIndexOf('/') + 1);
                
                openModal('edit-course-modal');
            }
        }

        // Save course changes
        function saveCourseChanges() {
            const course = sampleData.courses.find(c => c.id === currentState.editingCourseId);
            if (!course) return;
            
            course.name = document.getElementById('edit-course-name').value;
            course.category = document.getElementById('edit-course-category').value;
            course.level = document.getElementById('edit-course-level').value;
            course.description = document.getElementById('edit-course-description').value;
            course.duration = parseInt(document.getElementById('edit-course-duration').value);
            course.quiz.passingScore = parseInt(document.getElementById('edit-course-passing-score').value);
            
            // Handle image upload if any
            const imageInput = document.getElementById('edit-course-image');
            if (imageInput.files.length > 0) {
                const file = imageInput.files[0];
                const reader = new FileReader();
                reader.onload = function(event) {
                    course.image = event.target.result;
                };
                reader.readAsDataURL(file);
            }
            
            // Close modal
            closeModal('edit-course-modal');
            
            // Refresh views
            loadAllCourses();
            loadDashboard();
            loadAdminData();
            
            if (currentState.currentCourse && currentState.currentCourse.id === course.id) {
                viewCourseDetails(course.id);
            }
            
            alert('Kurs erfolgreich aktualisiert!');
        }

        // Delete course
        function deleteCourse(courseId) {
            if (confirm('Möchten Sie diesen Kurs wirklich löschen? Alle zugehörigen Daten werden ebenfalls gelöscht.')) {
                // Remove course from sample data
                sampleData.courses = sampleData.courses.filter(c => c.id !== courseId);
                
                // Remove related certificates
                const certsToRemove = sampleData.certificates.filter(c => c.courseId === courseId).length;
                sampleData.certificates = sampleData.certificates.filter(c => c.courseId !== courseId);
                
                // Update admin stats
                sampleData.adminStats.courses -= 1;
                sampleData.adminStats.certificates -= certsToRemove;
                
                // Refresh views
                loadAllCourses();
                loadDashboard();
                loadAdminData();
                
                if (currentState.currentCourse && currentState.currentCourse.id === courseId) {
                    showPage('courses');
                }
                
                alert('Kurs wurde gelöscht!');
            }
        }

        // Show add module modal
        function showAddModuleModal() {
            document.getElementById('add-module-form').reset();
            document.getElementById('module-video-url').style.display = 'none';
            document.getElementById('module-file-upload').style.display = 'none';
            document.getElementById('module-quiz-options').style.display = 'none';
            openModal('add-module-modal');
        }

        // Add new module
        function addNewModule() {
            const name = document.getElementById('module-name').value;
            const description = document.getElementById('module-description').value;
            const type = document.getElementById('module-type').value;
            
            // Validate inputs
            if (!name || !type) {
                alert('Bitte füllen Sie alle erforderlichen Felder aus.');
                return;
            }
            
            if (!currentState.currentCourse) return;
            
            // Create new module
            const newModule = {
                id: currentState.currentCourse.modules.length + 1,
                name,
                type,
                duration: 30, // Default duration
                completed: false
            };
            
            // Add to current course
            currentState.currentCourse.modules.push(newModule);
            
            // Close modal
            closeModal('add-module-modal');
            
            // Refresh course details
            viewCourseDetails(currentState.currentCourse.id);
            
            alert('Modul erfolgreich hinzugefügt!');
        }

        // Edit module
        function editModule(moduleId) {
            // In a real app, you would open a modal with the module data to edit
            alert(`Modul mit ID ${moduleId} bearbeiten...`);
        }

        // Delete module
        function deleteModule(moduleId) {
            if (confirm('Möchten Sie dieses Modul wirklich löschen?')) {
                if (currentState.currentCourse) {
                    currentState.currentCourse.modules = currentState.currentCourse.modules.filter(m => m.id !== moduleId);
                    
                    // Refresh course details
                    viewCourseDetails(currentState.currentCourse.id);
                    
                    alert('Modul wurde gelöscht!');
                }
            }
        }

        // Show add question modal
        function showAddQuestionModal() {
            document.getElementById('add-question-form').reset();
            openModal('add-question-modal');
        }

        // Add new question
        function addNewQuestion() {
            const questionText = document.getElementById('question-text').value;
            const type = document.getElementById('question-type').value;
            const points = document.getElementById('question-points').value;
            
            // Validate inputs
            if (!questionText || !type || !points) {
                alert('Bitte füllen Sie alle erforderlichen Felder aus.');
                return;
            }
            
            if (!currentState.currentCourse) return;
            
            // Get options
            const options = [];
            const optionElements = document.querySelectorAll('.d-flex.align-items-center.mb-10');
            
            optionElements.forEach(el => {
                const text = el.querySelector('input[type="text"]').value;
                const correct = el.querySelector('input[type="checkbox"]').checked;
                
                if (text) {
                    options.push({
                        text,
                        correct
                    });
                }
            });
            
            if (options.length < 2) {
                alert('Bitte fügen Sie mindestens zwei Optionen hinzu.');
                return;
            }
            
            // Create new question
            const newQuestion = {
                id: currentState.currentCourse.quiz.questions.length + 1,
                question: questionText,
                type,
                options,
                points: parseInt(points)
            };
            
            // Add to current course quiz
            currentState.currentCourse.quiz.questions.push(newQuestion);
            
            // Close modal
            closeModal('add-question-modal');
            
            alert('Frage erfolgreich hinzugefügt!');
        }

        // Add new option to question
        function addNewOption() {
            const optionsContainer = document.getElementById('question-options-container');
            const newOption = document.createElement('div');
            newOption.className = 'd-flex align-items-center mb-10';
            newOption.innerHTML = `
                <input type="text" class="form-control" placeholder="Optionstext" style="flex: 1;">
                <label style="margin-left: 10px; display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox" style="margin-right: 5px;"> Korrekt
                </label>
                <button class="btn btn-outline btn-sm" style="margin-left: 10px;" onclick="removeOption(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            optionsContainer.insertBefore(newOption, optionsContainer.lastElementChild);
        }

        // Remove option from question
        function removeOption(button) {
            button.parentElement.remove();
        }

        // Delete certificate
        function deleteCertificate(certId) {
            if (confirm('Möchten Sie dieses Zertifikat wirklich löschen?')) {
                // Remove certificate from sample data
                sampleData.certificates = sampleData.certificates.filter(c => c.id !== certId);
                
                // Update admin stats
                sampleData.adminStats.certificates -= 1;
                
                // Refresh certificates list
                loadCertificates();
                loadAdminData();
                
                alert('Zertifikat wurde gelöscht!');
            }
        }

        // Open modal
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }
    </script>
</body>
</html>